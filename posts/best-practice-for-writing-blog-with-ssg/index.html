<!doctype html><html lang=zh><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ffffff name=theme-color><meta content=#da532c name=msapplication-TileColor><link href=/icons/site.webmanifest rel=manifest><link color=#5bbad5 href=/icons/safari-pinned-tab.svg rel=mask-icon><link href=/icons/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/icons/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/icons/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link crossorigin=anonymous href=https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/themes/folio/galleria.folio.min.css integrity=sha384-+rY0QD+LRnTOquDMzGa9lXU6jIwdiQuwCJQ2cdcW0qeP/0UbjQCZlXnRsUMA+9pH rel=stylesheet><link crossorigin=anonymous href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.1/css/academicons.min.css integrity=sha384-FIue+PI4SsI9XfHCz8dBLg33b0c1fMJgNU3X//L26FYbGnlSEfWmNT7zgWc2N9b6 rel=stylesheet><link crossorigin=anonymous href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css integrity=sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm rel=stylesheet><link crossorigin=anonymous href=https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css integrity=sha384-IJLmUY0f1ePPX6uSCJ9Bxik64/meJmjSYD7dHaJqTXXEBE4y+Oe9P2KBZa/z7p0Q rel=stylesheet><link href=https://charmer.fun/deep-thought.css rel=stylesheet><title> Aurora | 使用静态网站写博客的最佳实践 </title><script src="https://www.googletagmanager.com/gtag/js?id=G-LXDSXGWDES" async></script><script>window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "G-LXDSXGWDES");</script><link crossorigin=anonymous href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs rel=stylesheet><script crossorigin=anonymous defer integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js></script><script crossorigin=anonymous defer integrity=sha384-jiBVvJ8NGGj5n7kJaiWwWp9AjC+Yh8rhZY3GtAX8yU28azcLgoRo4oukO87g7zDT src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mathtex-script-type.min.js></script><script crossorigin=anonymous defer integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js></script><body class=has-background-white><nav aria-label="section navigation" class="navbar is-light" role=navigation><div class=container><div class=navbar-brand><a class="navbar-item is-size-5 has-text-weight-bold" href=https://charmer.fun>Aurora</a><a class="navbar-burger burger" aria-expanded=false aria-label=menu data-target=navMenu role=button> <span aria-hidden=true></span> <span aria-hidden=true></span> <span aria-hidden=true></span> </a></div><div class=navbar-menu id=navMenu><div class="navbar-end has-text-centered"><a class="navbar-item has-text-weight-semibold" href=https://charmer.fun/> Home </a><a class="navbar-item has-text-weight-semibold" href=https://charmer.fun/posts> Posts </a><a class="navbar-item has-text-weight-semibold" href=https://charmer.fun/categories> Categories </a><a class="navbar-item has-text-weight-semibold" href=https://charmer.fun/tags> Tags </a><a class=navbar-item data-target=#search-modal id=nav-search title=Search> <span class=icon> <i class="fas fa-search"></i> </span> </a><a title="Switch to dark theme" class=navbar-item id=dark-mode> <span class=icon> <i class="fas fa-adjust"></i> </span> </a></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-8 is-offset-2"><article class=box><h1 class=title>使用静态网站写博客的最佳实践</h1><p class=subtitle>SSG+Github存储源码+Github Action自动编译+Github Pages发布网站<div class="columns is-multiline is-gapless"><div class="column is-8"><span class="icon-text has-text-grey"> <span class=icon> <i class="fas fa-user"></i> </span> <span>charmer published on</span> <span class=icon> <i class="far fa-calendar-alt"></i> </span> <span><time datetime=2022-02-11T20:37:06+08:00>February 11, 2022</time></span> </span></div><div class="column is-4 has-text-right-desktop"><span class="icon-text has-text-grey"> <span class=icon> <i class="far fa-clock"></i> </span> <span>5 min,</span> <span class=icon> <i class="fas fa-pencil-alt"></i> </span> <span>851 words</span> </span></div><div class=column></div><div class="column has-text-right-desktop"><p>Tags: <a class="has-text-info-dark has-text-weight-semibold" href=https://charmer.fun/tags/best-practice/> <span class=icon-text> <span class=icon> <i class="fas fa-tag"></i> </span> <span>best practice</span> </span> </a> <a class="has-text-info-dark has-text-weight-semibold" href=https://charmer.fun/tags/tip/> <span class=icon-text> <span class=icon> <i class="fas fa-tag"></i> </span> <span>tip</span> </span> </a></div></div><div class="content mt-2"><p>我尝试过hexo，用过hugo，最终转向zola这个完全还没发展起来的SSG。这篇文章记录下使用SSG写博客的最佳实践。<h2 id=zhu-ti-xuan-ze>主题选择</h2><p>主题选择驱使我从hugo迁移到zola。我对主题的要求非常苛刻：<ol><li>积极维护中，并且有庞大的用户群体。<li>样式简洁美观，我倾向于fluent design。<li>功能简单但不单调 <ol><li>支持latex渲染<li>支持toc<li>（可选）支持评论<li>（可选）支持admonition</ol><li>我极其讨厌复杂庞大的可选项（没错，我也讨厌kde），所以配置文件越精简越好。</ol><p>在hugo中，我从Loveit（似乎停止维护了）搬迁到papermod（非常惊艳，但是公式渲染需要html代码配置，并且渲染异常），再尝试了stack（太花哨）、terminal（风格不喜）、MemE（配置项过于庞大），我逃离到了zola。再一番抉择后发现了现在正在使用的主题<a rel="noopener nofollow noreferrer" href=https://github.com/RatanShreshtha/DeepThought target=_blank>DeepThought</a>，它是zola中几乎最流行的主题，界面简洁优美，配置精简，原生支持渲染，toc可选，支持评论，唯一的缺点就是缺少中文搜索的支持。<h2 id=bo-ke-yuan-wen-ben-cun-chu>博客源文本存储</h2><p>首先，博客的源码肯定是要纳入版本管理的，理所当然需要给它们创建一个仓库。<p>这里有一些约定：<ol><li>只有网站本身使用的图片（图标、头像）放到static文件夹中，其他博文图片全部使用图床的方式+markdown链接引用。<li>画图尽量使用mermaid、plantuml、draw.io这些纯文图图片来记录。draw.io同样存储于图床。</ol><h2 id=bo-ke-jing-tai-wang-zhan-cun-chu>博客静态网站存储</h2><p>想要使用Github Pages，需要创建一个仓库用于存储build出来的静态网站文件。<h2 id=bo-ke-bian-yi-zi-dong-hua>博客编译自动化</h2><p>现在源码在仓库A中，编译的静态网站在仓库B中，每次写完博文都需要手动build下然后推送仓库B、仓库A，这当然无法忍受。<p>于是可以利用Github Action配置流水线，每次提交到仓库A都会触发流水线，自动编译发布仓库B。<p>这里涉及到仓库A的编译发布流水线提交git到仓库B的权限问题，github可以使用token来解决。<p>但是我更倾向于使用仓库级密钥：<p>通过以下命令创建一对SSh key：<pre class=language-bash data-lang=bash style=background-color:#282828;color:#fdf4c1aa;><code class=language-bash data-lang=bash><span style=color:#fdf4c1;>ssh-keygen -t rsa -b 4096 -C </span><span style=color:#b8bb26;>"$(</span><span style=color:#fdf4c1;>git config user.email</span><span style=color:#b8bb26;>)"</span><span style=color:#fdf4c1;> -f gh-pages -N </span><span style=color:#b8bb26;>""
</span></code></pre><p>将生成的gh-pages.pub公钥配置仓库B，允许写入。并将生成的gh-pages私钥配置仓库A的私有变量，我将它命名为<code>ZOLA</code>。<p>这是我zola的配置，<code>.github/workflows/deploy-website.yml</code>：<pre class=language-yaml data-lang=yaml style=background-color:#282828;color:#fdf4c1aa;><code class=language-yaml data-lang=yaml><span style=font-weight:bold;color:#8ec07c;>name</span><span>: </span><span style=color:#b8bb26;>CI
</span><span style=color:#d3869b;>on</span><span>:
</span><span>  </span><span style=font-weight:bold;color:#8ec07c;>push</span><span>:
</span><span>    </span><span style=font-weight:bold;color:#8ec07c;>branches</span><span>: [ </span><span style=color:#b8bb26;>main </span><span>]
</span><span>  </span><span style=font-weight:bold;color:#8ec07c;>workflow_dispatch</span><span>:
</span><span style=font-weight:bold;color:#8ec07c;>jobs</span><span>:
</span><span>  </span><span style=font-weight:bold;color:#8ec07c;>build-and-deploy</span><span>:
</span><span>    </span><span style=font-weight:bold;color:#8ec07c;>runs-on</span><span>: </span><span style=color:#b8bb26;>ubuntu-latest
</span><span>    </span><span style=font-weight:bold;color:#8ec07c;>steps</span><span>:
</span><span>      - </span><span style=font-weight:bold;color:#8ec07c;>name</span><span>: </span><span style=color:#b8bb26;>Checkout the code
</span><span>        </span><span style=font-weight:bold;color:#8ec07c;>uses</span><span>: </span><span style=color:#b8bb26;>actions/checkout@master
</span><span>        </span><span style=font-weight:bold;color:#8ec07c;>with</span><span>:
</span><span>          </span><span style=font-weight:bold;color:#8ec07c;>submodules</span><span>: </span><span style=color:#d3869b;>true
</span><span>      - </span><span style=font-weight:bold;color:#8ec07c;>name</span><span>: </span><span style=color:#b8bb26;>Build Static Website
</span><span>        </span><span style=font-weight:bold;color:#8ec07c;>uses</span><span>: </span><span style=color:#b8bb26;>shalzz/zola-deploy-action@master
</span><span>        </span><span style=font-weight:bold;color:#8ec07c;>env</span><span>:
</span><span>          </span><span style=font-weight:bold;color:#8ec07c;>BUILD_ONLY</span><span>: </span><span style=color:#d3869b;>true
</span><span>          </span><span style=font-weight:bold;color:#8ec07c;>BUILD_DIR</span><span>: </span><span style=color:#d3869b;>.
</span><span>      - </span><span style=font-weight:bold;color:#8ec07c;>name</span><span>: </span><span style=color:#b8bb26;>Deploy Static Website
</span><span>        </span><span style=font-weight:bold;color:#8ec07c;>uses</span><span>: </span><span style=color:#b8bb26;>peaceiris/actions-gh-pages@v3
</span><span>        </span><span style=font-weight:bold;color:#8ec07c;>with</span><span>: 
</span><span>         </span><span style=font-weight:bold;color:#8ec07c;>deploy_key</span><span>: </span><span style=color:#b8bb26;>${{ secrets.ZOLA }}
</span><span>         </span><span style=font-weight:bold;color:#8ec07c;>external_repository</span><span>: </span><span style=color:#b8bb26;>oliverdding/oliverdding.github.io
</span><span>         </span><span style=font-weight:bold;color:#8ec07c;>publish_branch</span><span>: </span><span style=color:#b8bb26;>main
</span><span>         </span><span style=font-weight:bold;color:#8ec07c;>publish_dir</span><span>: </span><span style=color:#b8bb26;>./public
</span><span>         </span><span style=font-weight:bold;color:#8ec07c;>user_name</span><span>: </span><span style=color:#b8bb26;>'github-actions[bot]'
</span><span>         </span><span style=font-weight:bold;color:#8ec07c;>user_email</span><span>: </span><span style=color:#b8bb26;>'github-actions[bot]@users.noreply.github.com'
</span><span>         </span><span style=font-weight:bold;color:#8ec07c;>full_commit_message</span><span>: </span><span style=color:#b8bb26;>${{ github.event.head_commit.message }}
</span></code></pre><p>shalzz/zola-deploy-action也可以直接推送，但是我想K.I.S.S些，就职责分离了。hexo、hugo大体相同，只要改动第二部build即可。<h2 id=kuo-zhan>扩展</h2><p>当然，也可以选择第三方发布平台部署静态网站，比如比较出名的<a href=netlify.com>netify</a>和<a href=vercel.com>vercel</a>，此时只需要源码仓库即可编译发布静态博客。</div></article></div><div class="column is-2 is-hidden-mobile"><aside style="position: sticky; top: 48px" class=menu><p class="heading has-text-weight-bold">Contents<ul class=menu-list><li><a class="toc is-size-7 is-active" href=https://charmer.fun/posts/best-practice-for-writing-blog-with-ssg/#zhu-ti-xuan-ze id=link-zhu-ti-xuan-ze> 主题选择 </a><li><a class="toc is-size-7" href=https://charmer.fun/posts/best-practice-for-writing-blog-with-ssg/#bo-ke-yuan-wen-ben-cun-chu id=link-bo-ke-yuan-wen-ben-cun-chu> 博客源文本存储 </a><li><a class="toc is-size-7" href=https://charmer.fun/posts/best-practice-for-writing-blog-with-ssg/#bo-ke-jing-tai-wang-zhan-cun-chu id=link-bo-ke-jing-tai-wang-zhan-cun-chu> 博客静态网站存储 </a><li><a class="toc is-size-7" href=https://charmer.fun/posts/best-practice-for-writing-blog-with-ssg/#bo-ke-bian-yi-zi-dong-hua id=link-bo-ke-bian-yi-zi-dong-hua> 博客编译自动化 </a><li><a class="toc is-size-7" href=https://charmer.fun/posts/best-practice-for-writing-blog-with-ssg/#kuo-zhan id=link-kuo-zhan> 扩展 </a></ul></aside></div></div></div></section><section class=modal id=search-modal><div class=modal-background></div><div class=modal-card><header class=modal-card-head><p class=modal-card-title>Search</header><section class=modal-card-body><div class="field mb-2"><div class=control><input placeholder="Search this website." class=input id=search type=search></div></div><div class=search-results><div class=search-results__items></div></div></section></div><button class="modal-close is-large" aria-label=close></button></section><section class=section><div class=container><div class="columns is-centered"><div class="column is-8"><nav class=level><div class="level-item has-text-centered"><a class="button is-black is-outlined" href=https://charmer.fun/posts/bloom-filter-2/> <span class="icon mr-2"> <i class="fas fa-arrow-circle-left"></i> </span> 2 可扩展布隆过滤器 </a></div><div class="level-item has-text-centered"><a class="button is-black is-outlined" href=https://charmer.fun/posts/bloom-filter-1/> 1 基础布隆过滤器<span class="icon ml-2"> <i class="fas fa-arrow-circle-right"></i> </span> </a></div></nav></div></div></div></section><section class=section><div class=container><div class="columns is-centered"><div class="column is-6"><div id=disqus_thread></div></div></div></div></section><footer class="footer py-4"><div class="content has-text-centered"><p>Built with <span class=icon-text> <span class=icon> <i class="fas fa-code"></i> </span> <span>code</span> </span> and <span class=icon-text> <span class=icon> <i class="fas fa-heart"></i> </span> <span>love</span> </span><p>Powered by <span class=icon-text> <span class=icon> <i class="fas fa-power-off"></i> </span> <span>zola</span> </span></div></footer><script crossorigin=anonymous integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK src=https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js></script><script crossorigin=anonymous integrity=sha384-QSfwGT8/EU536DKdtyP2D6SLlh8zBaZ0cVkwfrwhqzIU9VCfJT00CLVP5t+HAiYg src=https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/galleria.min.js></script><script crossorigin=anonymous integrity=sha384-DwpKI+deZB267+hPKwiOIc5Y2GKsVL0mR6hgz7GgIu7AgAMYqJwcJKY1YBNfhWcY src=https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/themes/folio/galleria.folio.min.js></script><script crossorigin=anonymous integrity=sha384-0yWn54pSGtfKCU+skfA69l25VsCw+MZt4LQov3xNRoS7YkAMrFokGgSBnAWSK4pv src=https://cdn.jsdelivr.net/npm/mermaid@8.13.5/dist/mermaid.min.js></script><script crossorigin=anonymous integrity=sha384-xC3h1+IHXK8seA+8KfT79Z4e0GPsznjXBoMa5nd8ooWKplPyXx92NOmljWxLC/cs src=https://cdn.jsdelivr.net/npm/chart.xkcd@1.1.13/dist/chart.xkcd.min.js></script><script src=https://charmer.fun/elasticlunr.min.js></script><script src=https://charmer.fun/search_index.zh.js></script><script src=https://charmer.fun/js/site.js></script><script>const menuBarHeight = document.querySelector("nav.navbar").clientHeight;
  const tocItems = document.querySelectorAll(".toc");
  const navSections = new Array(tocItems.length);

  tocItems.forEach((el, i) => {
    let id = el.getAttribute("id").substring(5);
    navSections[i] = document.getElementById(id);
  })

  function isVisible(tocIndex) {
    const current = navSections[tocIndex];
    const next = tocIndex < tocItems.length - 1 ? navSections[tocIndex + 1]
      : document.querySelectorAll("section.section").item(1);

    const c = current.getBoundingClientRect();
    const n = next.getBoundingClientRect();
    const h = (window.innerHeight || document.documentElement.clientHeight);

    return (c.top <= h) && (n.top - menuBarHeight >= 0);
  }

  function activateIfVisible() {
    for (b = true, i = 0; i < tocItems.length; i++) {
      if (b && isVisible(i)) {
        tocItems[i].classList.add('is-active');
        b = false;
      } else
        tocItems[i].classList.remove('is-active');
    }
  }

  var isTicking = null;
  window.addEventListener('scroll', () => {
    if (!isTicking) {
      window.requestAnimationFrame(() => {
        activateIfVisible();
        isTicking = false;
      });
      isTicking = true;
    }
  }, false);</script><script>var disqus_config = function () {
    this.page.url = "https://charmer.fun";
    this.page.identifier = "/posts/best-practice-for-writing-blog-with-ssg/";
  };

  (function () {
    var d = document, s = d.createElement('script');
    s.src = 'https://oliverdding.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();</script>